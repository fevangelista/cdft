#! EE-CDFT CPH algorithm test, B3LYP computation on ethene

memory 250 mb

refdft                = -78.62361950910612 #TEST 
refocdft_singlet_spin = -78.366031258 #TEST
refocdft_triplet_spin = -78.455205000 #TEST

import cdft

molecule {
0 1
H   0.000000   0.923274   1.238289
H   0.000000  -0.923274   1.238289
H   0.000000   0.923274  -1.238289
H   0.000000  -0.923274  -1.238289
C   0.000000   0.000000   0.668188
C   0.000000   0.000000  -0.668188
}

set {
  basis def2-TZVP
  df_basis_scf cc-pVTZ-JKFIT
  guess sad
  scf_type df
  dft_spherical_points 302
  dft_radial_points 75
  reference uks
  maxiter 200
  e_convergence 11 
  d_convergence 6
}

set cdft {
  roots_per_irrep [0,0,0,0,0,1,0,0]
  cdft_exc_method chp
}

set dft_functional B3LYP

energy('cdft')

compare_values(refdft, get_variable("DFT ENERGY"),9, "DFT energy") #TEST
compare_values(refocdft_singlet_spin, get_variable("OCDFT SINGLET ENERGY"),9, "OCDFT singlet energy") #TEST
compare_values(refocdft_triplet_spin, get_variable("OCDFT TRIPLET ENERGY"),9, "OCDFT triplet energy") #TEST
